import{r as Se,R as Re,j as u}from"./index-1d78c4ac.js";import{B as Pe}from"./Breadcrumb-4b5ba697.js";import{P as Ne}from"./PageContainer-51f17055.js";import{P as qe}from"./ParentCard-b3c2f72c.js";import{S as I}from"./Stack-74791772.js";import{B as k}from"./Button-6de5bece.js";import{B as T}from"./Box-3b2e6d90.js";import{L as Ie}from"./List-eaf26c6f.js";import{L as ke}from"./ListItem-f171abd1.js";import"./index.esm-4ca6571d.js";import"./Grid-ba112631.js";import"./Link-5958468e.js";import"./Card-ed0a9074.js";import"./CardHeader-4375bfdf.js";import"./Divider-32914f08.js";import"./dividerClasses-40064371.js";import"./CardContent-97c31a3d.js";import"./createStack-08af7ebe.js";import"./styled-db48c038.js";import"./useThemeProps-a461f42f.js";import"./listItemButtonClasses-af8afb72.js";import"./isMuiElement-a2555389.js";class H{constructor(e,r){this.operator=e,this.value=r,Object.defineProperty(this,"t",{writable:!0})}get notes(){return this.t}addNote(e){this.t=this.t||[],this.t.push(e)}}let C=class extends H{};class y extends C{constructor(e,r){if(!Array.isArray(r))throw new Error(`"${e}" operator expects to receive an array of conditions`);super(e,r)}}const h="__itself__";let g=class extends H{constructor(e,r,n){super(e,n),this.field=r}};const W=new C("__null__",null),A=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty);function Te(t,e){return e instanceof y&&e.operator===t}function G(t,e){return e.length===1?e[0]:new y(t,function r(n,s,i){const o=i||[];for(let a=0,c=s.length;a<c;a++){const l=s[a];Te(n,l)?r(n,l.value,o):o.push(l)}return o}(t,e))}const Be=t=>t,K=()=>Object.create(null),Q=Object.defineProperty(K(),"__@type@__",{value:"ignore value"});function ze(t,e,r=!1){if(!t||t&&t.constructor!==Object)return!1;for(const n in t)if(A(t,n)&&A(e,n)&&(!r||t[n]!==Q))return!0;return!1}function Ue(t){const e=[];for(const r in t)A(t,r)&&t[r]!==Q&&e.push(r);return e}function x(t,e){e!==W&&t.push(e)}const X=t=>G("and",t),Z={compound(t,e,r){const n=(Array.isArray(e)?e:[e]).map(s=>r.parse(s));return new y(t.name,n)},field:(t,e,r)=>new g(t.name,r.field,e),document:(t,e)=>new C(t.name,e)};let Le=class{constructor(e,r=K()){this.o=void 0,this.s=void 0,this.i=void 0,this.u=void 0,this.h=void 0,this.parse=this.parse.bind(this),this.u={operatorToConditionName:r.operatorToConditionName||Be,defaultOperatorName:r.defaultOperatorName||"eq",mergeFinalConditions:r.mergeFinalConditions||X},this.o=Object.keys(e).reduce((n,s)=>(n[s]=Object.assign({name:this.u.operatorToConditionName(s)},e[s]),n),{}),this.s=Object.assign({},r.fieldContext,{field:"",query:{},parse:this.parse,hasOperators:n=>ze(n,this.o,r.useIgnoreValue)}),this.i=Object.assign({},r.documentContext,{parse:this.parse,query:{}}),this.h=r.useIgnoreValue?Ue:Object.keys}setParse(e){this.parse=e,this.s.parse=e,this.i.parse=e}parseField(e,r,n,s){const i=this.o[r];if(!i)throw new Error(`Unsupported operator "${r}"`);if(i.type!=="field")throw new Error(`Unexpected ${i.type} operator "${r}" at field level`);return this.s.field=e,this.s.query=s,this.parseInstruction(i,n,this.s)}parseInstruction(e,r,n){return typeof e.validate=="function"&&e.validate(e,r),(e.parse||Z[e.type])(e,r,n)}parseFieldOperators(e,r){const n=[],s=this.h(r);for(let i=0,o=s.length;i<o;i++){const a=s[i];if(!this.o[a])throw new Error(`Field query for "${e}" may contain only operators or a plain object as a value`);x(n,this.parseField(e,a,r[a],r))}return n}parse(e){const r=[],n=this.h(e);this.i.query=e;for(let s=0,i=n.length;s<i;s++){const o=n[s],a=e[o],c=this.o[o];if(c){if(c.type!=="document"&&c.type!=="compound")throw new Error(`Cannot use parsing instruction for operator "${o}" in "document" context as it is supposed to be used in  "${c.type}" context`);x(r,this.parseInstruction(c,a,this.i))}else this.s.hasOperators(a)?r.push(...this.parseFieldOperators(o,a)):x(r,this.parseField(o,this.u.defaultOperatorName,a,e))}return this.u.mergeFinalConditions(r)}};function j(t,e){const r=t[e];if(typeof r!="function")throw new Error(`Unable to interpret "${e}" condition. Did you forget to register interpreter for it?`);return r}function De(t){return t.operator}function Ye(t,e){const r=e,n=r&&r.getInterpreterName||De;let s;switch(r?r.numberOfArguments:0){case 1:s=o=>{const a=n(o,r);return j(t,a)(o,i)};break;case 3:s=(o,a,c)=>{const l=n(o,r);return j(t,l)(o,a,c,i)};break;default:s=(o,a)=>{const c=n(o,r);return j(t,c)(o,a,i)}}const i=Object.assign({},r,{interpret:s});return i.interpret}function Je(t,e){return(r,...n)=>{const s=t(r,...n),i=e.bind(null,s);return i.ast=s,i}}function ee(t,e){if(!Array.isArray(e))throw new Error(`"${t.name}" expects value to be an array`)}function te(t,e){if(ee(t,e),!e.length)throw new Error(`"${t.name}" expects to have at least one element in array`)}const M=t=>(e,r)=>{if(typeof r!==t)throw new Error(`"${e.name}" expects value to be a "${t}"`)},re={type:"compound",validate:te,parse(t,e,{parse:r}){const n=e.map(s=>r(s));return G(t.name,n)}},Ve=re,He={type:"compound",validate:te},We={type:"field",validate(t,e){if(!(e&&(e instanceof RegExp||e.constructor===Object)))throw new Error(`"${t.name}" expects to receive either regular expression or object of field operators`)},parse(t,e,r){const n=e instanceof RegExp?new g("regex",r.field,e):r.parse(e,r);return new y(t.name,[n])}},ne={type:"field",validate(t,e){if(!e||e.constructor!==Object)throw new Error(`"${t.name}" expects to receive an object with nested query or field level operators`)},parse(t,e,{parse:r,field:n,hasOperators:s}){const i=s(e)?r(e,{field:h}):r(e);return new g(t.name,n,i)}},se={type:"field",validate:M("number")},$={type:"field",validate:ee},ie=$,oe=$,Ge={type:"field",validate(t,e){if(!Array.isArray(e)||e.length!==2)throw new Error(`"${t.name}" expects an array with 2 numeric elements`)}},ae={type:"field",validate:M("boolean")},_={type:"field",validate:function(t,e){if(!(typeof e=="string"||typeof e=="number"||e instanceof Date))throw new Error(`"${t.name}" expects value to be comparable (i.e., string, number or date)`)}},b=_,ce=b,le=b,F={type:"field"},ue=F,pe={type:"field",validate(t,e){if(!(e instanceof RegExp)&&typeof e!="string")throw new Error(`"${t.name}" expects value to be a regular expression or a string that represents regular expression`)},parse(t,e,r){const n=typeof e=="string"?new RegExp(e,r.query.$options||""):e;return new g(t.name,r.field,n)}},he={type:"field",parse:()=>W},Ke={type:"document",validate:M("function")};var Qe=Object.freeze({__proto__:null,$and:re,$or:Ve,$nor:He,$not:We,$elemMatch:ne,$size:se,$in:$,$nin:ie,$all:oe,$mod:Ge,$exists:ae,$gte:_,$gt:b,$lt:ce,$lte:le,$eq:F,$ne:ue,$regex:pe,$options:he,$where:Ke});let Xe=class extends Le{constructor(e){super(e,{defaultOperatorName:"$eq",operatorToConditionName:r=>r.slice(1)})}parse(e,r){return r&&r.field?X(this.parseFieldOperators(r.field,e)):super.parse(e)}};const O=Qe;function S(t,e,r){for(let n=0,s=t.length;n<s;n++)if(r(t[n],e)===0)return!0;return!1}function R(t,e){return Array.isArray(t)&&Number.isNaN(Number(e))}function B(t,e,r){if(!R(t,e))return r(t,e);let n=[];for(let s=0;s<t.length;s++){const i=r(t[s],e);i!==void 0&&(n=n.concat(i))}return n}function p(t){return(e,r,n)=>{const s=n.get(r,e.field);return Array.isArray(s)?s.some(i=>t(e,i,n)):t(e,s,n)}}const Ze=(t,e)=>t[e];function fe(t,e,r){const n=e.lastIndexOf(".");return n===-1?[t,e]:[r(t,e.slice(0,n)),e.slice(n+1)]}function et(t,e,r=Ze){if(e===h)return t;if(!t)throw new Error(`Unable to get field "${e}" out of ${String(t)}.`);return function(n,s,i){if(s.indexOf(".")===-1)return B(n,s,i);const o=s.split(".");let a=n;for(let c=0,l=o.length;c<l;c++)if(a=B(a,o[c],i),!a||typeof a!="object")return a;return a}(t,e,r)}function de(t,e){return t===e?0:t>e?1:-1}function me(t,e={}){return Ye(t,Object.assign({get:et,compare:de},e))}const ye=(t,e,{interpret:r})=>t.value.some(n=>r(n,e)),tt=(t,e,r)=>!ye(t,e,r),ge=(t,e,{interpret:r})=>t.value.every(n=>r(n,e)),rt=(t,e,{interpret:r})=>!r(t.value[0],e),P=(t,e,{compare:r,get:n})=>{const s=n(e,t.field);return Array.isArray(s)&&!Array.isArray(t.value)?S(s,t.value,r):r(s,t.value)===0},$e=(t,e,r)=>!P(t,e,r),be=p((t,e,r)=>{const n=r.compare(e,t.value);return n===0||n===-1}),ve=p((t,e,r)=>r.compare(e,t.value)===-1),we=p((t,e,r)=>r.compare(e,t.value)===1),xe=p((t,e,r)=>{const n=r.compare(e,t.value);return n===0||n===1}),je=(t,e,{get:r})=>{if(t.field===h)return e!==void 0;const[n,s]=fe(e,t.field,r),i=o=>o==null?!!o===t.value:o.hasOwnProperty(s)===t.value;return R(n,s)?n.some(i):i(n)},nt=p((t,e)=>typeof e=="number"&&e%t.value[0]===t.value[1]),Ae=(t,e,{get:r})=>{const[n,s]=fe(e,t.field,r),i=o=>{const a=r(o,s);return Array.isArray(a)&&a.length===t.value};return t.field!==h&&R(n,s)?n.some(i):i(n)},Oe=p((t,e)=>typeof e=="string"&&t.value.test(e)),v=p((t,e,{compare:r})=>S(t.value,e,r)),Ee=(t,e,r)=>!v(t,e,r),Ce=(t,e,{compare:r,get:n})=>{const s=n(e,t.field);return Array.isArray(s)&&t.value.every(i=>S(s,i,r))},Me=(t,e,{interpret:r,get:n})=>{const s=n(e,t.field);return Array.isArray(s)&&s.some(i=>r(t.value,i))},st=(t,e)=>t.value.call(e);var it=Object.freeze({__proto__:null,or:ye,nor:tt,and:ge,not:rt,eq:P,ne:$e,lte:be,lt:ve,gt:we,gte:xe,exists:je,mod:nt,size:Ae,regex:Oe,within:v,nin:Ee,all:Ce,elemMatch:Me,where:st});const N=Object.assign({},it,{in:v});me(N);function z(t){return t instanceof Date?t.getTime():t&&typeof t.toJSON=="function"?t.toJSON():t}const ot=(t,e)=>de(z(t),z(e));function q(t,e,r){const n=new Xe(t),s=me(e,Object.assign({compare:ot},r));if(r&&r.forPrimitives){const i={field:h},o=n.parse;n.setParse(a=>o(a,i))}return Je(n.parse,s)}q(O,N);q(["$and","$or"].reduce((t,e)=>(t[e]=Object.assign({},t[e],{type:"field"}),t),Object.assign({},O,{$nor:Object.assign({},O.$nor,{type:"field",parse:Z.compound})})),N,{forPrimitives:!0});function E(t){return Array.isArray(t)?t:[t]}const U="__caslSubjectType__",m=t=>{const e=typeof t;return e==="string"||e==="function"},at=t=>t.modelName||t.name;function _e(t){return Object.hasOwn(t,U)?t[U]:at(t.constructor)}const L={function:t=>t.constructor,string:_e};function D(t,e,r){for(let n=r;n<e.length;n++)t.push(e[n])}function Y(t,e){if(!t||!t.length)return e||[];if(!e||!e.length)return t||[];let r=0,n=0;const s=[];for(;r<t.length&&n<e.length;)t[r].priority<e[n].priority?(s.push(t[r]),r++):(s.push(e[n]),n++);return D(s,t,r),D(s,e,n),s}function f(t,e,r){let n=t.get(e);return n||(n=r(),t.set(e,n)),n}const ct=t=>t;function lt(t,e){if(Array.isArray(t.fields)&&!t.fields.length)throw new Error("`rawRule.fields` cannot be an empty array. https://bit.ly/390miLa");if(t.fields&&!e.fieldMatcher)throw new Error('You need to pass "fieldMatcher" option in order to restrict access by fields');if(t.conditions&&!e.conditionsMatcher)throw new Error('You need to pass "conditionsMatcher" option in order to restrict access by conditions')}class ut{constructor(e,r,n=0){lt(e,r),this.action=r.resolveAction(e.action),this.subject=e.subject,this.inverted=!!e.inverted,this.conditions=e.conditions,this.reason=e.reason,this.origin=e,this.fields=e.fields?E(e.fields):void 0,this.priority=n,this.t=r}i(){return this.conditions&&!this.o&&(this.o=this.t.conditionsMatcher(this.conditions)),this.o}get ast(){const e=this.i();return e?e.ast:void 0}matchesConditions(e){return this.conditions?!e||m(e)?!this.inverted:this.i()(e):!0}matchesField(e){return this.fields?e?(this.fields&&!this.u&&(this.u=this.t.fieldMatcher(this.fields)),this.u(e)):!this.inverted:!0}}function pt(t,e){const r={value:t,prev:e,next:null};return e&&(e.next=r),r}function ht(t){t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t.next=t.prev=null}const ft=t=>({value:t.value,prev:t.prev,next:t.next}),J=()=>({rules:[],merged:!1}),V=()=>new Map;class dt{constructor(e=[],r={}){this.h=!1,this.l=new Map,this.p={conditionsMatcher:r.conditionsMatcher,fieldMatcher:r.fieldMatcher,resolveAction:r.resolveAction||ct},this.$=r.anyAction||"manage",this.A=r.anySubjectType||"all",this.m=e,this.M=!!r.detectSubjectType,this.j=r.detectSubjectType||_e,this.v(e)}get rules(){return this.m}detectSubjectType(e){return m(e)?e:e?this.j(e):this.A}update(e){const r={rules:e,ability:this,target:this};return this._("update",r),this.m=e,this.v(e),this._("updated",r),this}v(e){const r=new Map;let n;for(let s=e.length-1;s>=0;s--){const i=e.length-s-1,o=new ut(e[s],this.p,i),a=E(o.action),c=E(o.subject||this.A);!this.h&&o.fields&&(this.h=!0);for(let l=0;l<c.length;l++){const Fe=f(r,c[l],V);n===void 0&&(n=typeof c[l]),typeof c[l]!==n&&n!=="mixed"&&(n="mixed");for(let w=0;w<a.length;w++)f(Fe,a[w],J).rules.push(o)}}if(this.l=r,n!=="mixed"&&!this.M){const s=L[n]||L.string;this.j=s}}possibleRulesFor(e,r=this.A){if(!m(r))throw new Error('"possibleRulesFor" accepts only subject types (i.e., string or class) as the 2nd parameter');const n=f(this.l,r,V),s=f(n,e,J);if(s.merged)return s.rules;const i=e!==this.$&&n.has(this.$)?n.get(this.$).rules:void 0;let o=Y(s.rules,i);return r!==this.A&&(o=Y(o,this.possibleRulesFor(e,this.A))),s.rules=o,s.merged=!0,o}rulesFor(e,r,n){const s=this.possibleRulesFor(e,r);if(n&&typeof n!="string")throw new Error("The 3rd, `field` parameter is expected to be a string. See https://stalniy.github.io/casl/en/api/casl-ability#can-of-pure-ability for details");return this.h?s.filter(i=>i.matchesField(n)):s}actionsFor(e){if(!m(e))throw new Error('"actionsFor" accepts only subject types (i.e., string or class) as a parameter');const r=new Set,n=this.l.get(e);n&&Array.from(n.keys()).forEach(i=>r.add(i));const s=e!==this.A?this.l.get(this.A):void 0;return s&&Array.from(s.keys()).forEach(i=>r.add(i)),Array.from(r)}on(e,r){this.F=this.F||new Map;const n=this.F,s=n.get(e)||null,i=pt(r,s);return n.set(e,i),()=>{const o=n.get(e);!i.next&&!i.prev&&o===i?n.delete(e):i===o&&n.set(e,i.prev),ht(i)}}_(e,r){if(!this.F)return;let n=this.F.get(e)||null;for(;n!==null;){const s=n.prev?ft(n.prev):null;n.value(r),n=s}}}class mt extends dt{can(e,r,n){const s=this.relevantRuleFor(e,r,n);return!!s&&!s.inverted}relevantRuleFor(e,r,n){const s=this.detectSubjectType(r),i=this.rulesFor(e,s,n);for(let o=0,a=i.length;o<a;o++)if(i[o].matchesConditions(r))return i[o];return null}cannot(e,r,n){return!this.can(e,r,n)}}const yt={$eq:F,$ne:ue,$lt:ce,$lte:le,$gt:b,$gte:_,$in:$,$nin:ie,$all:oe,$size:se,$regex:pe,$options:he,$elemMatch:ne,$exists:ae},gt={eq:P,ne:$e,lt:ve,lte:be,gt:we,gte:xe,in:v,nin:Ee,all:Ce,size:Ae,regex:Oe,elemMatch:Me,exists:je,and:ge},$t=q(yt,gt),bt=/[-/\\^$+?.()|[\]{}]/g,vt=/\.?\*+\.?/g,wt=/\*+/,xt=/\./g;function jt(t,e,r){const n=r[0]==="*"||t[0]==="."&&t[t.length-1]==="."?"+":"*",s=t.indexOf("**")===-1?"[^.]":".",i=t.replace(xt,"\\$&").replace(wt,s+n);return e+t.length===r.length?`(?:${i})?`:i}function At(t,e,r){return t==="."&&(r[e-1]==="*"||r[e+1]==="*")?t:`\\${t}`}function Ot(t){const e=t.map(n=>n.replace(bt,At).replace(vt,jt)),r=e.length>1?`(?:${e.join("|")})`:e[0];return new RegExp(`^${r}$`)}const Et=t=>{let e;return r=>(typeof e>"u"&&(e=t.every(n=>n.indexOf("*")===-1)?null:Ot(t)),e===null?t.indexOf(r)!==-1:e.test(r))};function Ct(t=[],e={}){return new mt(t,Object.assign({conditionsMatcher:$t,fieldMatcher:Et},e))}function Mt(t){return typeof t.prototype.possibleRulesFor=="function"}class _t{constructor(e){this.O=e}because(e){return this.O.reason=e,this}}class Ft{constructor(e){this.rules=[],this.C=e,this.can=(r,n,s,i)=>this.R(r,n,s,i,!1),this.cannot=(r,n,s,i)=>this.R(r,n,s,i,!0),this.build=r=>Mt(this.C)?new this.C(this.rules,r):this.C(this.rules,r)}R(e,r,n,s,i){const o={action:e};return i&&(o.inverted=i),r&&(o.subject=r,Array.isArray(n)||typeof n=="string"?o.fields=n:typeof n<"u"&&(o.conditions=n),typeof s<"u"&&(o.conditions=s)),this.rules.push(o),new _t(o)}}function St(t,e){const r=new Ft(Ct),n=t(r.can,r.cannot);return n&&typeof n.then=="function"?n.then(()=>r.build(e)):r.build(e)}const Rt=()=>{};class Pt extends Se.PureComponent{constructor(...e){super(...e),this.t=!1,this.i=null,this.o=Rt}componentWillUnmount(){this.o()}u(e){e!==this.i&&(this.o(),this.i=null,e&&(this.i=e,this.o=e.on("updated",()=>this.forceUpdate())))}get allowed(){return this.t}h(){const e=this.props,r=e.of||e.a||e.an||e.this||e.on,n=e.not?"cannot":"can";return e.ability[n](e.I||e.do,r,e.field)}render(){return this.u(this.props.ability),this.t=this.h(),this.props.passThrough||this.t?this.l():null}l(){const{children:e,ability:r}=this.props;return typeof e=="function"?e(this.t,r):e}}const Nt=[{to:"/",title:"Home"},{title:"CASL"}],qt={CanEdit:{action:"Can-edit",subject:"address"},CanDelete:{action:"Can-delete",subject:"address"}},d={Admin:{permissions:["CanEdit","CanDelete"]},Manager:{permissions:["CanEdit"]},Subscriber:{permissions:[]}},It=[{city:"New York",street:"5684 Max Summit",type:"address"},{city:"Manhatten York",street:"5684 Max Summit",type:"address"},{city:"Canada street York",street:"5684 Max Summit",type:"address"},{city:"Delhi street",street:"5684 Max Summit",type:"address"},{city:"UP Chawk",street:"5684 Max Summit",type:"address"}],lr=()=>{const[t,e]=Re.useState(Object.keys(d)[0]),r=d[t].permissions.map(i=>qt[i]),n=[...r.reduce((i,{action:o})=>(i.add(o),i),new Set)],s=St(i=>{r.forEach(({action:o,subject:a})=>{i(o,a)})});return u.jsxs(Ne,{title:"Rollbase Access",description:"this is Rollbase Access",children:[u.jsx(Pe,{title:"Pricing",items:Nt}),u.jsxs(qe,{title:"Permission Base Access with CASL",children:[u.jsx(I,{direction:"row",gap:1,children:Object.entries(d).map(([i])=>u.jsx(k,{variant:t!==i?"outlined":"contained",color:"primary",onClick:()=>e(i),children:i},i))}),u.jsx(T,{p:2,mt:2,bgcolor:"primary.light",children:d[t].permissions.map(i=>u.jsx(T,{children:i},i))}),u.jsx(Ie,{children:It.map(({city:i,street:o,type:a})=>u.jsx(ke,{children:u.jsxs(I,{direction:"row",gap:1,alignItems:"center",children:[i,", ",o,n.map(c=>u.jsx(Pt,{I:c,a,ability:s,children:u.jsx(k,{size:"small",children:c})}))]})},i))})]})]})};export{lr as default};
